<div class="app-container">
  <header>
    <h1>{{ title() }}</h1>
    <p>Modern Angular Data Table with Internal and External Controls</p>
  </header>

  <main>
    <section class="table-section">
      <h2>Internal Controls (Built-in Search)</h2>
      <p class="section-description">
        This table uses internal search and filtering. The search input is built into the table component.
      </p>
      <app-table [data]="users()" [columns]="columns" />
    </section>

    <section class="table-section">
      <h2>External Controls (Parent-Managed Search & Filter)</h2>
      <p class="section-description">
        This table uses external search query and filter function controlled by the parent component.
        The internal search UI is hidden when external controls are provided.
      </p>
      
      <div class="external-controls">
        <div class="control-group">
          <label for="external-search">Search:</label>
          <div class="search-wrapper">
            <input
              id="external-search"
              type="text"
              class="external-search-input"
              placeholder="Search users..."
              [value]="externalSearchQuery()"
              (input)="onExternalSearchChange($any($event.target).value)"
            />
            @if (externalSearchQuery()) {
              <button
                type="button"
                class="clear-external-search"
                (click)="clearExternalSearch()"
                aria-label="Clear search"
              >
                ✕
              </button>
            }
          </div>
        </div>
        
        <div class="control-group">
          <label>
            <input
              type="checkbox"
              [checked]="showActiveOnly()"
              (change)="showActiveOnly.set($any($event.target).checked)"
            />
            Show active users only
          </label>
        </div>
      </div>
      
      <app-table
        [data]="users()"
        [columns]="columns"
        [externalSearchQuery]="externalSearchQuery()"
        [externalFilter]="externalFilter()"
      />
    </section>

    <section class="table-section">
      <h2>External Controls with Apply Button</h2>
      <p class="section-description">
        This table uses external controls with an apply button pattern. Filters are only applied when the "Apply" button is clicked.
        You can set up multiple filters before applying them.
      </p>
      
      <div class="external-controls apply-pattern">
        <div class="control-group">
          <label for="pending-search">Search:</label>
          <div class="search-wrapper">
            <input
              id="pending-search"
              type="text"
              class="external-search-input"
              placeholder="Search users..."
              [value]="pendingSearchQuery()"
              (input)="onPendingSearchChange($any($event.target).value)"
            />
            @if (pendingSearchQuery()) {
              <button
                type="button"
                class="clear-external-search"
                (click)="clearPendingSearch()"
                aria-label="Clear search"
              >
                ✕
              </button>
            }
          </div>
        </div>
        
        <div class="control-group">
          <label>
            <input
              type="checkbox"
              [checked]="pendingShowActiveOnly()"
              (change)="pendingShowActiveOnly.set($any($event.target).checked)"
            />
            Show active users only
          </label>
        </div>

        <div class="control-group actions">
          <button
            type="button"
            class="apply-button"
            [disabled]="!hasPendingChanges()"
            (click)="applyFilters()"
          >
            Apply
          </button>
          <button
            type="button"
            class="reset-button"
            [disabled]="!appliedSearchQuery() && !appliedShowActiveOnly()"
            (click)="resetFilters()"
          >
            Reset
          </button>
        </div>
      </div>

      @if (hasPendingChanges()) {
        <div class="pending-indicator">
          <span class="pending-icon">⚠</span>
          You have pending changes. Click "Apply" to update the table.
        </div>
      }

      @if (appliedSearchQuery() || appliedShowActiveOnly()) {
        <div class="applied-filters">
          <strong>Applied filters:</strong>
          <span class="filter-tag">
            @if (appliedSearchQuery()) {
              Search: "{{ appliedSearchQuery() }}"
            }
          </span>
          @if (appliedShowActiveOnly()) {
            <span class="filter-tag">Active users only</span>
          }
        </div>
      }
      
      <app-table
        [data]="users()"
        [columns]="columns"
        [externalSearchQuery]="appliedSearchQuery()"
        [externalFilter]="appliedExternalFilter()"
      />
    </section>

    <section class="table-section">
      <h2>Row Selection - Multiple Selection</h2>
      <p class="section-description">
        This table supports multiple row selection. Use checkboxes to select multiple rows. Click the header checkbox to select/deselect all visible rows.
      </p>
      
      @if (selectedUsers().length > 0) {
        <div class="selection-info">
          <strong>{{ selectedUsers().length }}</strong> user(s) selected:
          <span class="selected-names">
            {{ selectedUserNames() }}
          </span>
        </div>
      }
      
      <app-table
        [data]="users()"
        [columns]="columns"
        [selectionMode]="'multiple'"
        [rowIdentifier]="getUserIdentifier"
        (selectionChange)="onSelectionChange($event)"
      />
    </section>

    <section class="table-section">
      <h2>Row Selection - Single Selection</h2>
      <p class="section-description">
        This table supports single row selection. Use radio buttons to select one row at a time.
      </p>
      
      @if (singleSelectedUser()) {
        <div class="selection-info">
          Selected user: <strong>{{ singleSelectedUser()?.name }}</strong>
          ({{ singleSelectedUser()?.email }})
        </div>
      }
      
      <app-table
        [data]="users()"
        [columns]="columns"
        [selectionMode]="'single'"
        [rowIdentifier]="getUserIdentifier"
        (selectionChange)="onSingleSelectionChange($event)"
      />
    </section>
  </main>
</div>

