<div class="app-container">
  <header>
    <h1>{{ title() }}</h1>
    <p>Modern Angular Data Table Component</p>
  </header>

  <main>
    <section class="table-section">
      <h2>Control Mode Toggle</h2>
      <p class="section-description">
        Switch between internal controls (built-in search) and external controls (parent-managed).
      </p>
      
      <div class="control-mode-toggle">
        <button
          type="button"
          class="mode-toggle-button"
          [class.active]="!useExternalControls()"
          (click)="setControlMode(false)"
        >
          Internal Controls
        </button>
        <button
          type="button"
          class="mode-toggle-button"
          [class.active]="useExternalControls()"
          (click)="setControlMode(true)"
        >
          External Controls
        </button>
      </div>

      @if (useExternalControls()) {
        <div class="external-controls">
          <div class="control-group">
            <label for="toggle-search">Search:</label>
            <div class="search-wrapper">
              <input
                id="toggle-search"
                type="text"
                class="external-search-input"
                placeholder="Search users..."
                [value]="toggleSearchQuery()"
                (input)="onToggleSearchChange($any($event.target).value)"
              />
              @if (toggleSearchQuery()) {
                <button
                  type="button"
                  class="clear-external-search"
                  (click)="clearToggleSearch()"
                  aria-label="Clear search"
                >
                  âœ•
                </button>
              }
            </div>
          </div>
          
          <div class="control-group">
            <label>
              <input
                type="checkbox"
                [checked]="toggleShowActiveOnly()"
                (change)="toggleShowActiveOnly.set($any($event.target).checked)"
              />
              Show active users only
            </label>
          </div>
        </div>
      }
      
      <app-table
        [data]="users()"
        [columns]="columns"
        [externalSearchQuery]="useExternalControls() ? toggleSearchQuery() : undefined"
        [externalFilter]="useExternalControls() ? toggleExternalFilter() : undefined"
        [enablePagination]="true"
        [pageSize]="5"
      />
    </section>

    <section class="table-section">
      <h2>Pagination</h2>
      <p class="section-description">
        Large datasets with pagination controls. Navigate between pages with customizable page sizes.
      </p>
      
      <app-table
        [data]="users()"
        [columns]="columns"
        [enablePagination]="true"
        [pageSize]="3"
      />
    </section>

    <section class="table-section">
      <h2>Selection with Pagination</h2>
      <p class="section-description">
        Multiple row selection combined with pagination. Selections persist across pages.
      </p>
      
      @if (selectedUsers().length > 0) {
        <div class="selection-info">
          <strong>{{ selectedUsers().length }}</strong> user(s) selected:
          <span class="selected-names">
            {{ selectedUserNames() }}
          </span>
        </div>
      }
      
      <app-table
        [data]="users()"
        [columns]="columns"
        [selectionMode]="'multiple'"
        [rowIdentifier]="getUserIdentifier"
        (selectionChange)="onSelectionChange($event)"
        [enablePagination]="true"
        [pageSize]="4"
      />
    </section>

    <section class="table-section">
      <h2>Performance Demo - 10,000 Rows</h2>
      <p class="section-description">
        Large dataset with 10,000 randomly generated users. Demonstrates pagination performance with search, sorting, and filtering capabilities.
      </p>
      
      <div class="performance-stats">
        <div class="stat-item">
          <strong>{{ largeDataset().length.toLocaleString() }}</strong>
          <span>Total Records</span>
        </div>
        <div class="stat-item">
          <strong>{{ activeUsersCount().toLocaleString() }}</strong>
          <span>Active Users</span>
        </div>
        <div class="stat-item">
          <strong>{{ uniqueRolesCount() }}</strong>
          <span>Unique Roles</span>
        </div>
      </div>
      
      <app-table
        [data]="largeDataset()"
        [columns]="columns"
        [enablePagination]="true"
        [pageSize]="25"
      />
    </section>

    <section class="table-section">
      <h2>External API Pagination</h2>
      <p class="section-description">
        Server-side pagination using JSONPlaceholder API. Pagination controls trigger API calls to fetch new data pages.
      </p>
      
      <div class="api-info">
        <div class="api-endpoint">
          <strong>API Endpoint:</strong>
          <code>https://jsonplaceholder.typicode.com/posts?_limit={{ postsPerPage }}&_start={{ (currentPage() - 1) * postsPerPage }}</code>
        </div>
        <div class="api-stats">
          <span class="stat">Page {{ currentPage() }} of {{ totalPages() }}</span>
          <span class="stat">{{ totalPosts() }} total posts</span>
          @if (postsService.isLoading()) {
            <span class="loading-indicator">ðŸ”„ Loading...</span>
          }
        </div>
      </div>
      
      <app-table
        [data]="posts()"
        [columns]="postsColumns"
        [enablePagination]="true"
        [pageSize]="postsPerPage"
        [externalCurrentPage]="currentPage()"
        [externalTotalItems]="totalPosts()"
        [loading]="postsService.isLoading()"
        (pageChange)="onPostsPageChange($event)"
      />
    </section>
  </main>
</div>

